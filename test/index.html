


<html>
    
    <head>
        
    </head>
    
    
    <body>
        
        <script>
        
        
            function loadScript(src,cb) {
                
                const _a         = Array.prototype, cpArgs = _a.slice.call.bind (_a.slice);
                
                
                var ifrm = document.createElement('iframe');
                var html = '<html><head></head><body><script src="'+src+'"></'+'script></body></html>';
                ifrm.src = 'data:text/html;charset=utf-8,' + encodeURI(html);
                
                let script = document.createElement("script");
                script.src = src;
                
                
                const hooked = []; 
                function hook(fn,args){
                    if (fn==='define' || fn==='require') {
                       hooked.push([fn,src,ifrm,script,args]);
                       cb (hooked);
                    } else {
                        timeout = setTimeout(scriptLoadTimeout,100);
                    }
                }
                        
                ifrm.require = ifrm.contentWindow.require = function () {
                    hook("require",cpArgs(arguments));
                };        
                        
                ifrm.define = ifrm.contentWindow.define = function () {
                    hook("define",cpArgs(arguments));
                };
                ifrm.define.amd={};
                
                
                
                document.body.appendChild(ifrm); // to place at end of document

            } 
            
            

            loadScript("test.js",function(args) {
                
                
                console.log(args);
            });
            
            
            
            
        </script>
        
    </body>
</html>