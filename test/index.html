


<html>
    
    <head>
        
    </head>
    
    
    <body>
        
        <script>
        
        
            function loadScript(src,cb) {
                
                const _a         = Array.prototype, cpArgs = _a.slice.call.bind (_a.slice);
                
                var iframe = document.createElement('iframe');
                iframe.onload = function() {
                     
                    const hooked = []; 
                    function hook(fn,args){
                        if (fn==='define' || fn==='require') {
                           hooked.push([fn,src,iframe,script,args]);
                           cb (hooked);
                        }
                    }
                     
                    iframe.require = function () {
                        hook("require",cpArgs(arguments));
                    };        
                            
                    iframe.define = function () {
                        hook("define",cpArgs(arguments));
                    };
                    iframe.define.amd={};
                    
                    
                    iframe.contentWindow.define  = iframe.define;
                    iframe.contentWindow.require = iframe.require;
                    
                    
                    const script = document.createElement("script");
                    script.src=src;
                    iframe.contentWindow.document.body.appendChild(script);
                    
                };
                iframe.src = 'about:blank';
                document.body.appendChild(iframe);

            } 
            
            

            loadScript("test.js",function(args) {
                
                
                console.log(args);
            });
            
            
            
            
        </script>
        
    </body>
</html>